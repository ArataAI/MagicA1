<Window x:Class="MagicA1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Style="{StaticResource MaterialDesignWindow}"
        xmlns:local="clr-namespace:MagicA1"
        mc:Ignorable="d"
        Title="MagicA1" Height="300" Width="300" AllowDrop="True" WindowStyle="None"
        ResizeMode="NoResize" AllowsTransparency="True"
        WindowStartupLocation="CenterScreen" MouseLeftButtonDown="Grid_MouseLeftButtonDown" Background="Transparent" BorderThickness="0">
    <Window.Resources>
        <!-- Define the DrawingImage resource -->
        <DrawingImage x:Key="FolderIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V128 H128 V0 H0 Z">
                    <DrawingGroup Opacity="1" Transform="0.26081239,0,0,0.26081239,-2.7795703,-0.192645">
                        <GeometryDrawing Brush="#FF376CFB" Geometry="F1 M128,128z M0,0z M20.2,73.24C26.14,67.26 34.55,63.92 42.96,64.01 82.98,64 123,64 163.02,64.01 172.93,63.87 182.86,67.21 190.56,73.48 195.17,77.17 198.65,81.99 202.38,86.51 207.65,92.95 212.84,99.45 218.15,105.85 224.18,113.12 233.54,117.43 242.98,117.32 297.35,117.37 351.71,117.28 406.07,117.37 422.07,117.34 436.45,131.05 437.21,147.02 437.48,162 437.27,177 437.32,192 353.54,191.99 269.76,192.01 185.98,192 180.01,192.05 173.93,191.6 168.09,193.07 158.77,195.28 150.46,201.37 145.53,209.57 142.2,214.91 140.89,221.13 139.1,227.08 121.41,287.71 103.75,348.34 86.04,408.96 83.39,417.31 82,426.42 76.41,433.48 70.74,441.25 61.8,445.9 52.56,447.96 46,448.25 39.22,447.83 33.14,445.14 22.04,440.46 13.42,430.05 11.3,418.14 10.58,414.47 10.66,410.71 10.66,407 10.68,303.34 10.65,199.69 10.68,96.03 10.65,87.57 14.12,79.14 20.2,73.24z" />
                    </DrawingGroup>
                    <DrawingGroup Opacity="1" Transform="0.26081239,0,0,0.26081239,-2.7795703,-0.192645">
                        <GeometryDrawing Brush="#FF4294FF" Geometry="F1 M128,128z M0,0z M168.09,193.07C173.93,191.6 180.01,192.05 185.98,192 269.76,192.01 353.54,191.99 437.32,192 451.55,192 465.78,192.01 480.01,191.99 487.96,191.63 495.66,196.65 499.17,203.69 501.63,208.51 502.04,214.23 500.61,219.43 481.24,285.83 461.88,352.23 442.52,418.63 441.44,422.58 440.11,426.52 437.97,430.05 431.51,441.13 418.86,448.55 405.95,448.01 288.15,447.96 170.36,448.06 52.5600000000001,447.96 61.8000000000001,445.9 70.7400000000001,441.25 76.4100000000001,433.48 82.0000000000001,426.42 83.3900000000001,417.31 86.0400000000001,408.96 103.75,348.34 121.41,287.71 139.1,227.08 140.89,221.13 142.2,214.91 145.53,209.57 150.46,201.37 158.77,195.28 168.09,193.07z" />
                    </DrawingGroup>
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="CloseIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V2.8125 H2.8125 V0 H0 Z">
                    <DrawingGroup Opacity="1" Transform="0.140625,0,0,0.140625,-0.28125,-0.28125">
                        <GeometryDrawing Brush="#FF8C9E" Geometry="F1 M2.8125,2.8125z M0,0z M12,22C6.5,22 2,17.5 2,12 2,6.5 6.5,2 12,2 17.5,2 22,6.5 22,12 22,17.5 17.5,22 12,22z M12,4C7.6,4 4,7.6 4,12 4,16.4 7.6,20 12,20 16.4,20 20,16.4 20,12 20,7.6 16.4,4 12,4z" />
                    </DrawingGroup>
                    <DrawingGroup Opacity="1" Transform="0.140625,0,0,0.140625,-0.28125,-0.28125">
                        <GeometryDrawing Brush="#FF8C9E" Geometry="F1 M2.8125,2.8125z M0,0z M15,16C14.7,16,14.5,15.9,14.3,15.7L8.3,9.7C7.9,9.3 7.9,8.7 8.3,8.3 8.7,7.9 9.3,7.9 9.7,8.3L15.7,14.3C16.1,14.7 16.1,15.3 15.7,15.7 15.5,15.9 15.3,16 15,16z" />
                    </DrawingGroup>
                    <DrawingGroup Opacity="1" Transform="0.140625,0,0,0.140625,-0.28125,-0.28125">
                        <GeometryDrawing Brush="#FF8C9E" Geometry="F1 M2.8125,2.8125z M0,0z M9,16C8.7,16 8.5,15.9 8.3,15.7 7.9,15.3 7.9,14.7 8.3,14.3L14.3,8.3C14.7,7.9 15.3,7.9 15.7,8.3 16.1,8.7 16.1,9.3 15.7,9.7L9.7,15.7C9.5,15.9,9.3,16,9,16z" />
                    </DrawingGroup>
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="SAHO">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V30 H178.8374 V0 H0 Z">
                    <DrawingGroup Opacity="1" Transform="0.22544622,0,0,0.22544622,-11.363743,-12.63188">
                        <GeometryDrawing Brush="#77E4C8" Geometry="F1 M178.8374,30z M0,0z M75.25,80.45C82.65,68.98 93.69,58 107.84,56.22 119.38,54.75 129.85,62.05 136.69,70.68 140.52,76.6 144.49,82.85 145.09,90.06 145.8,95.08 143.45,100.09 139.62,103.27 136.26,105.77 132.11,106.71 128.03,107.2 123.13,107.48 118.35,106.21 113.66,104.98 113.69,104.36 113.75,103.11 113.78,102.48 115.05,99.09 115.24,95.45 114.6,91.91 114.4,88.52 114.72,84.95 113.27,81.77 111.86,80.32 109.73,81.5 108.5,82.58 102.41,87.96 99.31,95.75 97.1,103.37 95.57,106.27 95.56,109.69 96.93,112.65 98.91,118.52 103.74,122.68 108.13,126.78 111.69,129.63 114.91,132.93 118.82,135.33 124.57,139.48 130.25,143.78 135.45,148.61 137.26,150.76 139.56,152.99 139.7,155.98 140.04,161.17 137.17,166.02 133.6,169.57 125.1,178.27 113.69,183.41 102.14,186.68 93.96,188.87 85.15,189.87 76.92,187.32 67.82,184.41 59.23,179.49 52.6,172.55 49.63,169.79 50.59,165.56 50.44,161.97 50.54,159.07 49.93,155.6 52.34,153.41 57.54,147.21 66.21,145.91 73.84,146.72 75.48,147.15 77.12,147.59 78.69,148.27 80.75,153.9 80.67,160.13 83.01,165.72 91.48,164.28 99.12,160.02 106.91,156.6 106.74,154.33 104.33,153.5 102.86,152.15 92.68,143.92 82.33,135.59 74.35,125.11 70.6,119.28 66.36,113.25 66.11,106.05 66.59,96.8 70.85,88.39 75.25,80.45z" />
                        <GeometryDrawing Brush="#77E4C8" Geometry="F1 M178.8374,30z M0,0z M417.42,58.06C419.4,56.88 421.64,55.88 424.01,56.07 435.96,56.7 447.79,61.12 457.01,68.79 463.32,74.78 469.3,81.47 472.18,89.84 474.8,95.94 473.83,102.67 473.92,109.11 472.82,121.47 467.94,133.03 462.93,144.24L462.76,144.58C458.73,151.58 454.21,158.26 449.6,164.88 440.82,175.48 429.94,185.86 415.92,188.45 409.47,189.81 402.93,187.74 397.43,184.41 391.34,180.87 385.78,176.3 381.25,170.9 378.58,166.81 375.26,163.05 373.68,158.36 372.09,153.8 372.76,148.9 373.22,144.21 374.91,131.77 378.16,119.63 381.14,107.47 383.53,97.71 387.02,88.28 390.02,78.71L390.19,78.11C395.67,76.6 401.42,75.82 407.08,76.76 407.27,76.77 407.65,76.79 407.84,76.8 408.71,72.87 408.98,68.69 411.05,65.15 412.72,62.42 415.07,60.2 417.42,58.06 M418.03,95.84C407.21,116.75,401.13,140.31,401.94,163.93L402.74,164.04C409.97,161.61 416.56,157.41 422.12,152.21 424.6,150.65 426.49,148.37 428.33,146.13 439.22,132.58 446.56,116.36 450.59,99.5 447.3,96.38 443.14,94.23 438.77,93.1 432.53,90.57 425.75,89.36 419.04,89.38 416.75,90.61 419.34,93.9 418.03,95.84z" />
                        <GeometryDrawing Brush="#77E4C8" Geometry="F1 M178.8374,30z M0,0z M199.38,60.07C200.48,58.63 201.96,56.6 204.06,57.27 212.43,58.99 220.45,62.61 227.33,67.67 229.05,69.21 231.47,70.72 231.6,73.26 231.66,74.89 231.95,76.51 232.61,78.02 235.16,92.99 236.99,108.11 238.28,123.24 237.61,128.57 238.8,133.85 239.27,139.14 239.74,143.35 239.49,147.7 241.04,151.73 241.72,158.49 242.66,165.23 242.64,172.05 243.6,176.73 242.61,181.43 242.26,186.12 241.7,189.52 237.83,189.13 235.31,188.56 227.23,185.98 217.43,184.25 212.46,176.65 211.26,168.98 212.53,161.04 211.76,153.28L210.88,153.15C202.06,153.13 193.34,155.33 184.51,155.52 183.26,157.68 182.61,160.09 181.68,162.38 178.26,170.33 175.71,178.63 172.49,186.65 171.79,188.53 169.11,187.52 167.69,187.76 167.62,187.97 167.49,188.41 167.43,188.62L167.33,188.92C163.63,188.77 159.8,189.11 156.25,187.83 150.38,185.82 145.89,180.99 144.34,174.98 153.89,152.35 164.39,130.14 174.63,107.81 182.45,91.6900000000001 189.52,75.0900000000001 199.38,60.0700000000001 M209.35,89.3400000000001C204.91,98.4800000000001 201.55,108.13 197.76,117.57 196.67,121.23 194.47,124.63 194.29,128.51 199.74,128.33 205.18,127.91 210.6,127.31 210.96,127.02 211.69,126.45 212.06,126.16 211.72,117.46 212.58,108.7 211.42,100.05 211.05,97.6100000000001 212.03,94.9000000000001 210.69,92.6800000000001 210.66,91.4300000000001 210.61,90.1700000000001 210.54,88.9200000000001 210.25,89.0200000000001 209.65,89.2300000000001 209.35,89.3400000000001z" />
                        <GeometryDrawing Brush="#77E4C8" Geometry="F1 M178.8374,30z M0,0z M281.09,56.97C287.11,57.99 292.53,61.07 297.44,64.56 300.76,67.14 304.06,70.01 306,73.82 305.69,77.61 304.54,81.25 303.67,84.93 301.06,94.77 298.53,104.64 296.26,114.56 296.52,114.54 297.04,114.5 297.3,114.48 308.26,113.75 319.17,112.45 330.07,111.16L330.79,110.83C331.18,109.62 331.54,108.4 331.79,107.16 334.07,93.76 336.26,80.32 339.44,67.1 340.25,63.44 341.88,60.03 344.05,56.98 349.79,57.87 354.99,60.66 359.69,63.96 363.37,67.53 369.4,70.95 368.46,76.92 365.78,89.36 361.91,101.52 359.11,113.94 356.36,126.28 353.89,138.71 352.78,151.32 352.24,160.17 350.83,168.93 349.56,177.71 348.83,181.29 348.61,185.29 346.15,188.2 344.38,189.37 342.09,188.72 340.22,188.14 333.1,185.07 325.65,181.31 321.26,174.66 319.41,172.16 320.11,168.94 320.5,166.09 322.14,156.2 324.29,146.39 326.16,136.53L325.22,136.66C314.22,138.58,303.08,139.32,291.95,139.79L291.2,140.02C288.68,154.28 288.11,168.84 285.1,183.03 284.65,185.3 283.31,187.21 282.05,189.1 273.02,188.05 264.88,182.74 258.96,176.03 256.79,173.78 256.18,170.58 256.88,167.59 259.09,158.11 260.88,148.54 262.83,139 267.81,115.83 270.47,92.21 276.03,69.15 277.17,64.9 278.26,60.47 281.09,56.97z" />
                        <GeometryDrawing Brush="#77E4C8" Geometry="F1 M178.8374,30z M0,0z M553.34,58.92C554.12,57.84 555.34,56.7 556.81,57.2 565.01,60.3 573.24,64.6 578.56,71.78 581.35,75.37 578.69,79.7 578.07,83.56 573.77,99.41 569.52,115.3 566.55,131.46 564.47,144.57 563.08,157.77 561.26,170.91 560.3,176.79 559.9,182.92 557.17,188.33 554.35,189.65 551.22,188.1 548.5,187.21 541.64,184.05 534.81,179.61 531.05,172.87 531.34,162.24 534.76,152.03 536.44,141.58 540.51,122.86 543.12,103.86 546.72,85.04 548.55,76.2500000000001 550.21,67.37 553.34,58.92z" />
                        <GeometryDrawing Brush="#77E4C8" Geometry="F1 M178.8374,30z M0,0z M591.34,92.42C595.22,88.02 599.93,83.48 606,82.69 612.24,83.39 617.31,87.71 621.67,91.89 623.53,94.6 625.95,97.05 627.06,100.2 627.82,106.65 625.87,112.99 625.19,119.36 625.1,119.79 624.93,120.66 624.84,121.1 623.81,121.89 622.71,124.71 624.75,124.78 626.67,124.79 627.42,122.58 628.03,121.09 628.25,120.79 628.69,120.19 628.9,119.88 629.26,119.49 629.96,118.7 630.31,118.3 631.6,115.53 633.89,113.31 635.85,110.99 636.19,110.58 636.87,109.76 637.21,109.36 642.92,102.14 648.74,94.65 656.35,89.31 661.13,86.51 666.85,88.95 670.65,92.32 673.26,94.29 675.72,96.5 677.67,99.15 679.53,102.16 682.12,105.45 680.86,109.21 676.57,126.22 669.67,142.42 664.46,159.14 663.74,161.01 666.19,160.11 666.94,159.62 672.25,156.75 677.2,153.3 681.84,149.43 685.29,150.94 689.03,152.26 691.73,155.01 695.01,158.88 697.9,163.65 697.4,168.93 696.16,175.48 689.5,178.39 684.64,181.95 677.25,185.57 669.27,188.73 660.94,188.84 654,188.06 648.09,183.49 643.18,178.83 641.2,175.92 637.61,172.99 638.83,169.08 641.78,156.92 646.75,145.31 649.19,133.01 649.53,130.51 650.37,127.73 648.96,125.41 647.42,125.31 645.85,125.54 644.54,126.38 638.89,129.84 634.32,134.7 629.98,139.63 626.68,142.74 624.03,146.44 621.14,149.9 618.8,152.31 618.84,155.85 618.13,158.92 616.9,166.48 615.13,173.93 613.71,181.45 613.05,184.43 611.78,189.07 607.95,188.87 602.18,188.19 596.91,185.28 592.36,181.81 589.63,178.86 586.11,176.45 584.29,172.79 582.9,166.47 586.3,160.6 588.4,154.87 592.24,144.52 597.35,134.65 600.52,124.06 602.45,119.26 597.33,116.02 593.9,113.89 590.92,111.55 587.44,109.39 585.55,106.04 584.68,100.81 588.23,96.23 591.34,92.42z" />
                        <GeometryDrawing Brush="#77E4C8" Geometry="F1 M178.8374,30z M0,0z M741.29,87.31C755.81,79.62 774.95,81.85 787.63,92.15 790.84,95.56 794.51,99.1 795.18,103.99 796.12,108.44 794.4,112.85 791.66,116.31 786.81,121.17 779.38,122.49 772.82,121.26 769.71,115.7 767.51,108.85 761.99,105.26 758.71,106.32 756.13,109.24 753.53,111.5 741.68,124.14 736.39,141.92 736.53,158.98 736.91,160.67 736.03,164.18 738.76,163.89 751.49,163.99 762.5,155.43 770.25,146.02 776.85,147.43 783.74,150.55 787.32,156.57 789.8,160.49 790.18,165.47 789.16,169.9 785.68,177.08 778.08,181.1 771.02,184.04 760.56,187.89 748.71,190.9 737.81,187.06 728.66,183.67 720.48,177.67 714.39,170.07 710.92,164.94 707.39,159.42 707.05,153.06 706.69,139.79 710.93,126.95 716.34,115 721.83,103.72 730.39,93.67 741.29,87.31z" />
                        <GeometryDrawing Brush="#77E4C8" Geometry="F1 M178.8374,30z M0,0z M814.34,158.18C819.91,155.42 826.2,152.39 832.55,153.69 838.67,156.77 842.07,163.59 843.47,170.05 844.53,174.57 841.08,178.22 837.8,180.75 832.88,184.51 827.21,187.56 821.08,188.71 818.7,189.27 816.27,188.43 814.42,186.93 809.59,182.1 805.61,175.9 804.93,168.98 805.04,163.63 810.58,160.97 814.34,158.18z" />
                    </DrawingGroup>
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
    </Window.Resources>
    <Grid>
        <!-- Drag and Drop Area -->
        <Border Grid.Row="1" BorderBrush="Gray" CornerRadius="20" Background="#D1E9F6" BorderThickness="0" Padding="0" 
             AllowDrop="True" 
             DragOver="Border_DragOver"
             Drop="Border_Drop">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="60"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="32"/>
                    <RowDefinition Height="32"/>
                    <RowDefinition Height="32"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="60"/>
                </Grid.ColumnDefinitions>
                <!-- Close Button in the Top Right Corner -->
                <Button Grid.Row="0" Grid.Column="1"
                HorizontalAlignment="Right" 
                VerticalAlignment="Top" 
                Background="Transparent" 
                BorderBrush="Transparent" 
                 BorderThickness="0"
                        Padding="0"
                Click="CloseButton_Click" Margin="0,10,10,0">
                    <Image Source="{StaticResource CloseIcon}"/>
                </Button>

                    <!-- Folder Selection Button with SVG Image -->
                <Button Grid.Row="0" Grid.RowSpan="5" Grid.Column="0" Grid.ColumnSpan="2" Width="60" Height="60" Background="Transparent" BorderBrush="Transparent" BorderThickness="0" Padding="0" Click="SelectFolder_Click">
                    <Image Source="{StaticResource FolderIcon}"/>
                </Button>
                <Image Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2" Source="{StaticResource SAHO}" Height="15" HorizontalAlignment="Right" Margin="0,0,10,10"/>
                <!-- Status Snackbar -->
                <materialDesign:Snackbar x:Name="Statusbar" Grid.Row="2" Grid.RowSpan="3" Grid.Column="0" Grid.ColumnSpan="2" MessageQueue="{materialDesign:MessageQueue}" Margin="10,0,10,10" />
            </Grid>
        </Border>
    </Grid>
 
</Window>
